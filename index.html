<!DOCTYPE html>
<html>

<body>
    <button onclick="startCapture()">START</button>
    <br>
    <video id="video" style="display:none" autoplay></video>
    <canvas id="canvas"></canvas>
    <img id="img" src="">
</body>
<script>
    const video = document.getElementById("video");
    const img = document.getElementById("img");
    const canvas = document.createElement("canvas");
    // const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const displayMediaOptions = { video: { cursor: "always" }, audio: false };

    const startCapture = async () => {
        try {
            video.srcObject = await navigator.mediaDevices.getDisplayMedia(displayMediaOptions);
            loop();
        } catch (err) {
            console.error("Error: " + err);
        }
    }

    const loop = () => {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        img.src = canvas.toDataURL();
        setTimeout(loop, 0);
    }
</script>

</html>
